/**
 * Copyright 2016 VMware, Inc. All rights reserved.
 *
 * This source code is licensed under the VMware Technical Preview License.
 */
!function(){"use strict";function e(e){return Array.isArray(e)}function t(e){return null===e}function n(e){return"object"==typeof e}function r(e){return void 0===e}function i(e){return"undefined"===e}function a(e){return i(typeof crypto)?i(typeof require)||r(require("crypto"))?Math.random()*e:require("crypto").randomBytes(1)[0]%e:crypto.getRandomValues(new Uint8Array(1))[0]%e}function o(){var e=/[018]/g;return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(e,function(e){return(e^a(16)>>e/4).toString(16)})}function s(e,t){var n=Array(80).join("-");console.info(n),y(l(e),function(t){console.info(t.toLowerCase()+": "+e[t])}),t&&console.info(t)}function u(e){return e.replace(/[^_]_[^_]/g,function(e){return e.charAt(0)+e.charAt(2).toUpperCase()})}function c(e){return u(e).replace(/[^.]+$/,function(e){return/^[A-Z]{2}$/.test(e)?e:e.charAt(0).toLowerCase()+e.substr(1)})}function p(e){return u(e).replace(/[^.]+$/,function(e){return e.charAt(0).toUpperCase()+e.substr(1)})}function f(e,t,n){Object.defineProperty(e,t,{enumerable:!0,value:n})}function m(e){return y(l(e),function(t){n(e[t])&&m(e[t])}),Object.freeze(e)}function l(e){return Object.keys(e)}function v(e,t,n){return Array.prototype.slice.call(e,t,n)}function y(e,t){for(var n=0,r=e.length;n!==r;++n)t(e[n],n,e)}function d(e,t){return e.concat(t.filter(function(t){return e.indexOf(t)===-1}))}function h(e){var t=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,n=e.match(t);return{scheme:n[2],authority:n[4],path:n[5],query:n[7],fragment:n[9]}}function g(e){var t={},n=e.getAllResponseHeaders();if(n){var r=n.split("\r\n");y(r,function(e){var n=e.indexOf(": ");if(n>0){var r=e.substring(0,n),i=e.substring(n+2);t[r]=i}})}return t}function b(e){return new Promise(function(t,n){var a=e.protocol||"https",o=a+"://"+e.hostname+(r(e.port)?"":":"+e.port);e.headers=e.headers||{},e.headers["Content-Type"]=e.contentType,e.proxy&&(e.headers[e.proxyHeader]=o);var u=(e.proxy?"":o)+e.path+(r(e.query)?"":"?"+e.query),c=new(i(typeof XMLHttpRequest)?require("xmlhttprequest-cookie").XMLHttpRequest:XMLHttpRequest);if(c.open(e.method,u),r(c.overrideMimeType)||c.overrideMimeType(e.contentType),c.withCredentials=!0,y(l(e.headers),function(t){r(e.headers[t])||c.setRequestHeader(t,e.headers[t])}),c.onreadystatechange=function(){if(4===c.readyState){if(e.debug){var r={response:u,status:c.status};s(S(r,g(c)),c.responseText)}200===c.status?t(c):n(c)}},e.debug){var p={request:u,method:e.method};s(S(p,e.headers),e.data)}e.data?c.send(e.data):c.send()})}function x(e,t){for(var n=e.length-1;n!==-1;--n)if(0===t.indexOf(e[n].name))return n}function w(e,t,n){return e[t].types.indexOf(n)}function O(e,t,n){var i=x(e,t);if(!r(i)){var a=w(e,i,n);if(a!==-1)return[i,a]}}function T(t){return l(t).reduce(function(n,i){var a=t[i];return e(a)?0!==a.length&&(n[i]=a):r(a)||(n[i]=a),n},{})}function S(){for(var t=arguments[0],i=1,a=arguments.length;i!==a;++i){var o=arguments[i];y(l(o),function(i){(t[i]!==o[i]||r(t[i]))&&(e(t[i])&&e(o[i])?t[i]=d(t[i],o[i]):n(t[i])&&n(o[i])?t[i]=S(t[i],o[i]):t[i]=o[i])})}return t}function I(e,t,n){return l(e).reduce(function(i,a){var o=L(t,e[a].constructor);if(r(o))i[a]=e[a];else{var s=O(j(n),C(t,o),X(t,o)),u=ae(n,s);i[a]=S(u,I(e[a],t,n))}return i},{})}function k(e){return xe[e].implementation}function N(e){return xe[e].extensions}function E(e){return xe[e].methods}function R(e,t){return j(e)[A(t)]}function j(e){return xe[e].namespaces}function A(e){return e[ye]}function C(e,t){return R(e,t).name}function z(e){return e[de]}function U(e){return xe[e].objects}function L(e,t){return xe[e].names.get(t)}function q(e,t){var n=k(e),i=X(e,t);if(n.isArrayType(i))return Array;var a=C(e,t),o=U(e)[a][p(i)];return r(L(e,o))&&(xe[e].names.set(o,t),o.prototype=ie(e,t,o)),o}function M(e){return xe[e].operations}function B(e,t){return R(e,t).operations[z(t)]}function P(e,t){return M(e)[A(t)][z(t)]}function _(e){return xe[e].packages}function D(e,t){return H(e)[A(t)][z(t)]}function H(e){return xe[e].services}function G(e){return xe[e].types}function X(e,t){return R(e,t).types[z(t)]}function V(e,t){return G(e)[A(t)][z(t)]||{}}function J(e,t,n,i){var a=k(e),o=V(e,t),s=o[n]||i,u=o.base;if(!r(u)&&!a.isBuiltInType(u)){var c=J(e,u,n,i);s=d(c,s)}var p=o.unions||[];return p.reduce(function(t,r){var a=J(e,r,n,i);return d(t,a)},s)}function F(e,t){return J(e,t,"attributes",[])}function Q(e,t){return J(e,t,"constants",[])}function $(e,t){return J(e,t,"elements",[])}function K(e,t){return J(e,t,"enumerations",[])}function Y(e,t){var n=V(e,t).base;return r(n)?t:Y(e,n)}function W(e,t,n){r(xe[e])&&(xe[e]=S({extensions:{},implementation:n,methods:{},names:new Map,objects:{},packages:{}},t),y(t.namespaces,function(t,n){xe[e].methods[t.name]={},y(t.operations,function(r,i){var a=[n,i];f(xe[e].methods[t.name],c(r),se(e,a))}),xe[e].objects[t.name]={},y(t.types,function(i,a){var o=[n,a],s=V(e,o);if(!r(s.container)){var u=X(e,s.container);i=i.replace(u,p(u))}f(xe[e].objects[t.name],p(i),ce(e,o))}),r(t.services)||(xe[e].packages[t.name]={},y(t.services,function(r,i){var a=[n,i];f(xe[e].packages[t.name],c(r),pe(e,a))}))}))}function Z(e){delete xe[e],Te.removeItem(e)}function ee(e,t,n){try{Te.setItem(e,n)}catch(a){for(var r=0;r!==Te.length;++r){var i=Te.key(r);if(0===i.indexOf(t))return Te.removeItem(i),void ee(e,t,n)}console.warn("Could not free enough storage space.")}}function te(e,t,n){var r=t.implementation;return r.loadDefinitions(e,t).then(function(i){W(n,i,r);var a=ue(n,e,t,new Set),o=U(n);return t.init(n,t,a,o)}).then(function(e){var i={namespaces:j(n),operations:M(n),services:H(n),types:G(n)};return W(e.key,i,r),ee(e.key,t.key,JSON.stringify(i)),{props:I(e.props,n,e.key),key:e.key}})}function ne(e){for(var t=0;t!==Te.length;++t){var n=Te.key(t);if(0===n.indexOf(e))return n}}function re(e,n){var i=ne(n.key),a=n.implementation;if(r(i))return i=n.key,te(e,n,i);try{W(i,JSON.parse(Te.getItem(i)),a);var o=ue(i,e,n,new Set),s=U(i);return n.init(i,n,o,s).then(function(r){if(i!==r.key){var o=JSON.parse(Te.getItem(r.key));if(t(o))return te(e,n,r.key);try{return W(r.key,o,a),{props:I(r.props,i,r.key),key:r.key}}catch(t){return Z(r.key),te(e,n,r.key)}}return r})}catch(t){return Z(i),te(e,n,i)}}function ie(e,t,n){var i=k(e),a=V(e,t),o=a.elements||[],s=a.attributes||[],c=a.base,p={};y(o.concat(s),function(e){r(e.name)||(p[u(e.name)]={enumerable:!0,writable:!0})});var f=Object;return r(c)||(i.isBuiltInType(c)?p.value={enumerable:!0,writable:!0}:f=q(e,c)),p.constructor={value:n},Object.create(f.prototype,p)}function ae(e,t){return q(e,t)()}function oe(e,t){var n=RegExp("^"+t+".");return l(e[t]).reduce(function(i,a){var o=a.replace(n,"").split("."),s=e[t][a],u=i;return y(o,function(e,t){t+1===o.length?u[e]=s:r(u[e])?(u[e]={},u=u[e]):u=u[e]}),i},{})}function se(e,t){return function(n,a,o,s){var u=v(arguments,4),c=k(e);return new Promise(function(p,f){for(var m=c.serialize(e,t,u,s),l=c.createHeaders(e,t),v=o.values(),y=v.next();y.done===!1;){var d={body:m,headers:l,outgoing:!0};if(y.value(d)===!1)break;y=v.next()}var h=c.serializeRequest(m);b({contentType:a.contentType,data:h,debug:a.debug,headers:l,hostname:n,method:"POST",path:a.endpoint,port:a.port,proxy:a.proxy,proxyHeader:a.proxyHeader}).then(function(n){var a=c.parseResponse(n),s=o.values(),u=s.next(),m=g(n);if(i(typeof XMLHttpRequest)){var l=n.getResponseHeader("set-cookie");r(l)||(m["set-cookie"]=l)}for(;u.done===!1;){var v={body:a,headers:m,outgoing:!1};if(u.value(v)===!1)break;u=s.next()}try{p(c.deserialize(e,t,a))}catch(e){f(e)}},function(t){f(500===t.status&&t.responseText?c.deserializeError(e,c.parseResponse(t)):Error(t.statusText))})})}}function ue(e,t,n,r,i){var a={};return y(l(E(e)),function(o){a[o]={},y(l(E(e)[o]),function(s){a[o][s]=E(e)[o][s].bind(null,t,n,r,i)})}),a}function ce(e,t){var n=K(e,t);return 0!==n.length?n.reduce(function(e,t){return e[t]=t,e},{}):Q(e,t).reduce(function(e,t){return e[t.name]=t.value,e},function(n){var r=Object.create(q(e,t).prototype);return S(r,n||{})})}function pe(e,t){var n=D(e,t).constants||[];return n.reduce(function(e,t){return e[t.name]=t.value,e},{})}function fe(e,t){return re(e,t).then(function(n){var i=new Set,a=k(n.key),o=ue(n.key,e,t,i,n.props),s=U(n.key),u=_(n.key),c=S({addHandler:function(e){i.add(e)},removeHandler:function(e){i.delete(e)},serializeObject:a.serializeObject.bind(null,n.key),deserializeObject:a.deserializeObject.bind(null,n.key)},n.props),p=l(t.prefixes),v=p.reduce(function(e,n){return e[t.prefixes[n]]=n,e},{}),y=d(l(o),l(s),l(u));return y.filter(function(e){return!r(v[e])}).forEach(function(e){var t=oe(o,e),n=oe(s,e),r=oe(u,e);f(c,v[e],S(t,n,r))}),m(c)})}function me(e){!i(typeof exports)&&n(exports)&&!i(typeof module)&&n(module)?((i(typeof Map)||i(typeof Promise))&&require("es6-shim"),module.exports=e):"function"==typeof define&&define.amd?define([],e):i(typeof window)||(window.vsphere=e)}function le(){function e(t){return t.STRUCTURE?t.STRUCTURE[l(t.STRUCTURE)[0]]:t.OPTIONAL?e(t.OPTIONAL):t}function n(t,i){var a=e(i);switch(a.category){case"BUILTIN":var o=e(a.builtin_type);return{type:[0,t[0].types.indexOf(o)]};case"GENERIC":var s=e(a.generic_instantiation),u=e(s.generic_type),c={type:[1,t[1].types.indexOf(u)]};return r(s.element_type)||(c.typeElement=n(t,e(s.element_type))),r(s.map_key_type)||(c.typeKey=n(t,e(s.map_key_type))),r(s.map_value_type)||(c.typeValue=n(t,e(s.map_value_type))),c;case"USER_DEFINED":var p=e(a.user_defined_type),f=e(p.resource_id);return{type:O(t,f,f)}}}function i(t,n,r){var i=n.type,a=t[A(i)].types[z(i)];if(g.isBuiltInType(i))switch(a){case"STRING":var o=e(r).primitive_value,s=e(o).string_value;return e(s)}else if(g.isArrayType(i))switch(a){case"LIST":var u=e(r).list_value;return e(u).map(function(r){var i=n.typeElement.type,a=t[A(i)];switch(a.types[z(i)]){case"STRING":var o=e(r).string_value;return e(o)}})}}function a(t,r){var a=e(r).value,o=n(t,e(a).type);return S({name:e(r).key,value:i(t,o,e(a).value)},o)}function s(t){var i=[{name:"BUILTIN",operations:[],services:[],types:["ANY_ERROR","BINARY","BOOLEAN","DATE_TIME","DOUBLE","DYNAMIC_STRUCTURE","ID","LONG","OPAQUE","SECRET","STRING","URI","VOID"]},{name:"GENERIC",operations:[],services:[],types:["LIST","MAP","OPTIONAL","SET"]}],o=[[],[]],s=[[],[]],u=[[],[]],c=d(l(t.operations),l(t.services),l(t.types)).sort();return y(c,function(e){i.push({name:e,operations:l(t.operations[e]).map(function(e){return e}),services:l(t.services[e]).map(function(e){return e}),types:l(t.types[e]).map(function(e){return e})})}),y(c,function(r){var a=l(t.operations[r]);o.push(a.map(function(a){var o=t.operations[r][a];return[o.params.map(function(t){var r=e(t);return S({name:r.name},n(i,r.type))}),n(i,e(o.output).type)]}))}),y(c,function(n){var o=l(t.services[n]);s.push(o.reduce(function(o,s){var u=e(t.services[n][s]),c=[];return r(u.constants)||(c=u.constants.map(function(e){return a(i,e)})),o.push(T({constants:c})),o},[]))}),y(c,function(o){var s=l(t.types[o]);u.push(s.reduce(function(s,u){var c=e(t.types[o][u]);if(r(c.values)){var p=[];r(c.fields)||(p=c.fields.map(function(t){var r=e(t);return S({name:r.name},n(i,r.type))}));var f=[];r(c.constants)||(f=c.constants.map(function(e){return a(i,e)})),s.push(T({attributes:p,constants:f,type:c.type}))}else{var m={enumerations:c.values.map(function(t){return e(t).value})},l=O(i,o,c.container.name);r(l)||(m.container=l),s.push(m)}return s},[]))}),{namespaces:i,operations:o,services:s,types:u}}function c(t,n,r){y(r.enumerations,function(i){var a=e(i),o=e(a.value);t.types[n][a.key]=S({container:r},o)})}function p(t,n,r){y(r.services,function(r){var i=e(r),a=e(i.value);t.services[n][i.key]=a,y(a.operations,function(r){var a=e(r);t.operations[n][i.key+"."+a.key]=e(a.value)}),c(t,n,a),f(t,n,a)})}function f(t,n,r){y(r.structures,function(r){var i=e(r),a=e(i.value);t.types[n][i.key]=a,c(t,n,a)})}function m(t,n,r){var i=e(n.output),a=e(i.info),o=a.name;y(a.packages,function(t){var n=e(t),i=e(n.value);0===n.key.indexOf(o)&&(r.operations[o]=r.operations[o]||{},r.services[o]=r.services[o]||{},r.types[o]=r.types[o]||{},c(r,o,i),p(r,o,i),f(r,o,i))})}function v(t,n,i,a){return new Promise(function(o,s){var u=h(i.endpoint);b({contentType:i.contentType,data:g.serializeRequest({ctx:{appCtx:{}},input:{STRUCTURE:{"operation-input":{component_id:t}}},operationId:"get",serviceId:"com.vmware.vapi.metadata.metamodel.component"}),hostname:u.authority||n,method:"POST",path:u.path,port:i.port,protocol:u.scheme,proxy:i.proxy,proxyHeader:i.proxyHeader,query:u.query}).then(function(n){var s=g.parseResponse(n);if(!r(s.output)){var u=e(s.output),c=e(u.info);r(i.prefixes[c.name])||(c.name=i.prefixes[c.name]),m(t,s,a)}o()},function(e){s(Error(e.statusText))})})}var g={createHeaders:function(){return{}},createOptions:function(e,t){return S({},be,{init:function(e,t,n,i){var a=d(l(n),l(i)),s=t.definitions.filter(function(e){return e=t.prefixes[e]||e,a.indexOf(e)!==-1}),u=n["com.vmware.vapi"]["com.vmware.vapi.metadata.metamodel.component.fingerprint"];return Promise.all(s.map(function(e){return u(e).catch(function(){})})).then(function(e){var n,i=e.reduce(function(e,t){return e+(r(t)?"":t.substr(0,8))},"");return{key:[t.key,i].join("/"),props:{getSecurityContext:function(){return n},setSecurityContext:function(e){n=e},uuid:o}}})},contentType:"application/json",definitions:["com.vmware.vapi"],implementation:g,prefixes:{builtin:"BUILTIN",vapi:"com.vmware.vapi"}},e,t||{})},deserialize:function(e,t,n){if(!r(n.output)){var i=P(e,t),a=i[ge];return g.deserializeObject(e,n.output,a)}if(!r(n.error))throw g.deserializeError(e,n)},deserializeError:function(e,t){var n=Error();n.name=l(t.error.ERROR)[0];var i=O(j(e),n.name,n.name);n.info=g.deserializeObject(e,t.error,{type:i});var a=n.info.messages;return r(a)||0===a.length||(n.message=a[0].defaultMessage),n},deserializeObject:function(n,i,a){var o=a.type,s=a.typeElement,c=a.typeKey,p=X(n,o);if(g.isBuiltInType(o))switch(p){case"DATE_TIME":return new Date(i);case"ID":return i;case"SECRET":return i.SECRET;case"STRING":return i;case"VOID":return;default:return i}else{if(g.isArrayType(o))return i.map(function(e){return g.deserializeObject(n,e,s)});if(r(s)){if(r(c)){var f=V(n,o),m=K(n,o);if(0!==m.length)return i;var l=F(n,o);return l.reduce(function(e,a){if(!t(i)){var o=g.deserializeObject(n,i[f.type][p][a.name],a);r(o)||(e[u(a.name)]=o)}return e},ae(n,o))}var v=a.typeValue;return i.reduce(function(t,r){var i=e(r);return t[i.key]=g.deserializeObject(n,i.value,v),t},{})}if(!t(i[p]))return g.deserializeObject(n,i[p],s)}},isArrayType:function(e){return 1===A(e)&&(0==z(e)||3==z(e))},isBuiltInType:function(e){return 0===A(e)},loadDefinitions:function(e,t){var n={operations:{},services:{},types:{}};return Promise.all(t.definitions.map(function(r){return v(r,e,t,n)})).then(function(){return s(n)})},parseResponse:function(e){return JSON.parse(e.responseText).result},serialize:function(e,t,n,i){var a=B(e,t),s=a.split("."),u=s.pop(),c=s.join("."),p=P(e,t),f=n.reduce(function(t,n,r){var i=p[he][r];return t[i.name]=g.serializeObject(e,n,X(e,i.type),i),t},{});return{ctx:S({appCtx:{opId:o()}},r(i)?{}:{securityCtx:i.getSecurityContext()}),input:{STRUCTURE:{"operation-input":f}},operationId:u,serviceId:c}},serializeObject:function(e,t,n,i){var a=i.type,o=i.typeElement,s=i.typeKey,c=K(e,a);if(g.isBuiltInType(a)||0!==c.length)return t;if(g.isArrayType(a))return t.map(function(t){return g.serializeObject(e,t,X(e,o.type),o)});if(r(o)){if(r(s)){var p=V(e,a),f={};return f[p.type]={},f[p.type][n]={},y(p.attributes,function(r){f[p.type][n][r.name]=g.serializeObject(e,t[u(r.name)],r.name,r)}),f}return l(t).map(function(n){return{STRUCTURE:{"map-entry":{key:n,value:g.serializeObject(e,t[n],n,i.typeValue)}}}})}var m={};return m[X(e,a)]=r(t)?null:g.serializeObject(e,t,X(e,o.type),o),m},serializeRequest:function(e){return JSON.stringify({id:o(),jsonrpc:"2.0",method:"invoke",params:e})}};return g}function ve(){function a(e,t){return e.getAttribute(t)}function o(e,t){return e.getElementsByTagName(t)}function s(e,t,n){return e.getElementsByTagNameNS(t,n)}function u(e){for(var t=0,n=e.childNodes.length;t!==n;++t)if(1===e.childNodes[t].nodeType)return e.childNodes[t]}function c(e,t){return e.lookupNamespaceURI(t)}function p(e,t,n){var r,i,a=n.split(":");2===a.length?(r=c(t,a[0]),i=a[1]):(r=t.namespaceURI||ne,i=a[0]);var o=x(e,r),s=w(e,o,i);return s===-1&&y(e,function(t,n){var r=w(e,n,i);r!==-1&&(o=n,s=r)}),[o,s]}function f(e,t,n){var i=N(e);return r(i[n])&&(i[n]=p(j(e),t,n)),i[n]}function m(e,t,n){return e.setAttribute(t,n)}function g(e,t,n,r){return e.setAttributeNS(t,n,r)}function I(e,n){var i=ue.firstChild;if(r(i.getAttribute)||t(i.getAttribute("lineNumber")))return ue.createElementNS(e,n);var a=ue.createElement(n);return m(a,"xmlns",e),a}function k(e,n){var i=ue.firstChild,a=ue.implementation;if(r(i.getAttribute)||t(i.getAttribute("lineNumber")))return a.createDocument(e,n,null);var o=a.createDocument(null,n,null);return m(o.firstChild,"xmlns",e),o}function E(e){return ue.createTextNode(e)}function R(e,t){return e.appendChild(t)}function M(e,t,n){var r={};return y(t.attributes,function(i){var o=i.name,s=i.value;if("ref"===o){var u=s.split(":"),f=n[c(t,u[0])][u[1]];r.name=a(f,"name"),r.type=p(e,f,a(f,"type"))}else"type"===o?r.type=p(e,t,s):r[o]=s}),r}function B(e,t,n){switch(X(e,t)){case"anyType":case"anyURI":case"base64Binary":case"boolean":case"byte":case"date":case"dateTime":case"float":case"ID":case"int":case"integer":case"long":case"NCName":case"negativeInteger":case"nonNegativeInteger":case"nonPositiveInteger":case"positiveInteger":case"QName":case"short":case"string":case"unsignedLong":return n;default:throw Error("Unknown type")}}function _(e,t,n){switch(X(e,t)){case"anyURI":case"base64Binary":case"string":return n;case"boolean":return"true"===n.toLowerCase();case"byte":case"int":case"integer":case"long":case"NCName":case"negativeInteger":case"nonNegativeInteger":case"nonPositiveInteger":case"positiveInteger":case"QName":case"short":case"unsignedLong":return parseInt(n);case"dateTime":return new Date(n);case"float":return parseFloat(n);default:throw Error("Unknown type")}}function D(e,t,n){var r=a(n,"message").split(":"),i=t.messages[c(n,r[0])][r[1]],o=s(i,ee,"part")[0],u=a(o,"element").split(":");return t.elements[c(n,u[0])][u[1]]}function H(e,t,n,i,o){return new Promise(function(u,c){if(r(o[e])){o[e]={resolve:[u],reject:[c]};var p=h(e);b({contentType:n.contentType,hostname:p.authority||t,method:"GET",path:p.path,port:p.authority?"":n.port,protocol:p.scheme,proxy:n.proxy,proxyHeader:n.proxyHeader,query:p.query}).then(function(u){var c=ie.parseResponse(u),p=s(c,ee,"import"),f=s(c,ne,"import"),m=s(c,ne,"include"),l=v(p).concat(v(f)).concat(v(m));o[e].data=c,o[e].length=l.length,0===o[e].length?(G(o[e].data,i),y(o[e].resolve,function(e){e()})):y(l,function(s){var u=a(s,"location")||a(s,"schemaLocation"),c=h(u);r(c.scheme)?0!==c.path.indexOf("/")&&(u=e.replace(/[^\/]+$/,u)):u=c.path+(c.query?"?"+c.query:""),H(u,t,n,i,o).then(function(){o[e].length--,0===o[e].length&&(G(o[e].data,i),y(o[e].resolve,function(e){e()}))},function(t){y(o[e].reject,function(e){e(t)})})})},function(t){y(o[e].reject,function(e){e(Error(t.statusText))})})}else r(o[e].data)?(o[e].resolve.push(u),o[e].reject.push(c)):u(o[e].data)})}function G(e,n){var r=s(e,ee,"definitions");y(r,function(e){var t=a(e,"targetNamespace");n.actions[t]=n.actions[t]||{},n.messages[t]=n.messages[t]||{},n.operations[t]=n.operations[t]||{},y(e.childNodes,function(e){switch(e.localName){case"binding":n.bindings[t]=e,y(e.childNodes,function(e){if("operation"===e.localName){var r=a(e,"name");y(e.childNodes,function(e){"operation"===e.localName&&(n.actions[t][r]=e)})}});break;case"message":n.messages[t][a(e,"name")]=e;break;case"portType":y(e.childNodes,function(e){"operation"===e.localName&&(n.operations[t][a(e,"name")]=e)});break;case"service":y(e.childNodes,function(e){"port"===e.localName&&(n.ports[t]=e)})}})});var i=s(e,ne,"schema");y(i,function(e){var r=a(e,"targetNamespace");t(r)||""===r||(n.attributes[r]=n.attributes[r]||{},n.types[r]=n.types[r]||{},n.elements[r]=n.elements[r]||{},n.attributeGroups[r]=n.attributeGroups[r]||{},y(e.childNodes,function(e){switch(e.localName){case"attribute":n.attributes[r][a(e,"name")]=e;break;case"complexType":case"simpleType":n.types[r][a(e,"name")]=e;break;case"element":var t=a(e,"name");n.elements[r][t]=e,y(e.childNodes,function(e){"complexType"!==e.localName&&"simpleType"!==e.localName||(m(e,"name",t),m(n.elements[r][t],"type",e.lookupPrefix(r)+":"+t),n.types[r][t]=e)});break;case"attributeGroup":n.attributeGroups[r][a(e,"name")]=e}}))})}function J(e,t){return c(e.ports[t],a(e.ports[t],"binding").split(":")[0])}function Q(e,t){var n=[];if(!r(e.ports[t])){var i=e.bindings[J(e,t)];y(s(i,i.namespaceURI,"operation"),function(e){n.push(a(e,"name"))})}return n}function W(e){var t=[{name:ne,operations:[],services:[],types:["anyType","anyURI","base64Binary","boolean","byte","dateTime","double","float","ID","int","integer","long","NCName","negativeInteger","nonNegativeInteger","nonPositiveInteger","positiveInteger","QName","short","string","unsignedLong"]}],n=[[]],i=[[]],o=[[]],u=d(l(e.operations),l(e.types));return y(u,function(n){t.push({name:n,operations:Q(e,n),services:[],types:l(e.types[n]||{}).map(function(e){return e})})}),y(u,function(n){o.push(l(e.types[n]||{}).map(function(i){var o,u,f=[],m=[],l=e.types[n][i];y(l.childNodes,function(e){switch(e.localName){case"sequence":case"choice":case"all":o=a(e,"maxOccurs")||o,u=a(e,"minOccurs")||u}}),y(s(l,ne,"element"),function(n){var r=M(t,n,e.elements);"choice"===n.parentNode.localName&&(r.minOccurs="0",o=a(n.parentNode,"maxOccurs")||o),m.push(r)}),y(s(l,ne,"any"),function(e){m.push(M(t,e))}),y(s(l,ne,"attribute"),function(n){f.push(M(t,n,e.attributes))}),y(s(l,ne,"anyAttribute"),function(e){f.push(M(t,e))}),y(s(l,ne,"attributeGroup"),function(n){var r=a(n,"ref").split(":"),i=e.attributeGroups[c(n,r[0])][r[1]];y(s(i,ne,"attribute"),function(n){f.push(M(t,n,e.attributes))}),y(s(i,ne,"anyAttribute"),function(e){f.push(M(t,e))})});var v,d=s(l,ne,"extension")[0];r(d)||(v=p(t,d,a(d,"base")));var h=[],g=[];return"simpleType"===l.localName&&(y(s(l,ne,"restriction"),function(e){y(s(e,ne,"enumeration"),function(e){h.push(a(e,"value"))})}),y(s(l,ne,"union"),function(e){y(a(e,"memberTypes").split(/\s+/g),function(n){g.push(p(t,e,n))})})),T({attributes:f,base:v,elements:m,enumerations:h,maxOccurs:o,minOccurs:u,unions:g})}))}),y(u,function(i){if(r(e.ports[i]))n.push([]);else{var o=J(e,i),u=Q(e,i);n.push(u.map(function(n){var r=e.operations[o][n],i=D(t,e,s(r,ee,"input")[0]),u=D(t,e,s(r,ee,"output")[0]);return[{action:a(e.actions[o][n],"soapAction"),name:a(i,"name"),type:p(t,i,a(i,"type"))},{type:p(t,u,a(u,"type"))}]}))}}),{namespaces:t,operations:n,services:i,types:o}}var Z="http://schemas.xmlsoap.org/soap/envelope/",ee="http://schemas.xmlsoap.org/wsdl/",te="http://www.w3.org/2000/xmlns/",ne="http://www.w3.org/2001/XMLSchema",re="http://www.w3.org/2001/XMLSchema-instance",ie={createHeaders:function(e,t){var n=P(e,t);return{SOAPAction:n[he].action}},createOptions:function(e,t){return S({},be,{init:function(e,t){return new Promise(function(e){e({key:t.key,props:{}})})},contentType:"text/xml",implementation:ie,prefixes:{xs:"http://www.w3.org/2001/XMLSchema"}},e,t||{})},deserialize:function(e,t,n){var r=P(e,t),i=r[ge],a=u(s(n,Z,"Body")[0]),o=ie.deserializeObject(e,a,i);return o[l(o)[0]]},deserializeError:function(e,t){var n=o(t,"detail")[0],i=Error();if(i.name=o(t,"faultcode")[0].textContent,i.message=o(t,"faultstring")[0].textContent,!r(n)){var a=u(n),s=O(j(e),a.namespaceURI,a.nodeName);i.info=ie.deserializeObject(e,a,{type:s})}return i},deserializeObject:function(n,i,o){if(!t(i.textContent)){var s=a(i,"xsi:type"),u=s?f(n,i,s):o.type;if(ie.isBuiltInType(u))return _(n,u,i.textContent);var c,p=Y(n,u),m=K(n,u);0!==m.length?c=i.textContent:ie.isBuiltInType(p)?(c=ae(n,u),c.value=_(n,p,i.textContent)):c=ae(n,u);var l=V(n,u);return y($(n,u),function(t){var a=t.maxOccurs||l.maxOccurs,o="unbounded"===a;!o||e(c)||r(t.name)||(c[t.name]=[]),y(i.childNodes,function(i){if(i.localName===t.name){var a=ie.deserializeObject(n,i,t);r(a)||(o?e(c)?c.push(a):c[t.name].push(a):c[t.name]=a)}})}),y(F(n,u),function(e){y(i.attributes,function(t){if(t.name===e.name){var r=K(n,e.type);ie.isBuiltInType(e.type)?c[e.name]=_(n,e.type,t.value):0!==r.length?c[e.name]=t.value:(c[e.name]=ae(n,e.type),c[e.name].value=t.value)}})}),c}},isArrayType:function(e){return/^ArrayOf/.test(e)},isBuiltInType:function(e){return 0===A(e)},loadDefinitions:function(e,t){var n={actions:{},attributes:{},attributeGroups:{},bindings:{},elements:{},messages:{},operations:{},ports:{},types:{}};return Promise.all(t.definitions.map(function(r){return H(r,e,t,n,{})})).then(function(){return W(n)})},parseResponse:function(e){return e.responseXML.querySelector?e.responseXML:oe.parseFromString(e.responseText)},serialize:function(e,t,n){var i,a=P(e,t),o=a[he],s=F(e,o.type),u=$(e,o.type);0!==s.length?i=n[0]:(i=ae(e,o.type),y(u,function(e,t){r(n[t])||(i[e.name]=n[t])})),ie.validateObject(e,i,o.name,o);var c=k(Z,"Envelope"),p=c.documentElement;g(p,te,"xmlns:xsi",re);var f=I(Z,"Body");return R(R(p,f),ie.serializeObject(e,i,o.name,o)),c},serializeObject:function(i,a,o,s){var u,c=L(i,a.constructor);if(r(s))u=I(C(i,c),o);else{var p=s.type;u=I(C(i,p),o),A(c)===A(p)&&z(c)===z(p)||g(u,re,"xsi:type",X(i,c))}var f,v=l(a);y($(i,c),function(o){if(r(o.name))f=o;else{var s=a[o.name];if(!(r(s)&&v.indexOf(o.name)===-1||t(s))){var p=e(s)?s:[s];y(p,function(e){var t,r;if(!n(e)&&ie.isBuiltInType(o.type))r=C(i,c),t=I(r,o.name),R(t,E(B(i,o.type,e)));else{var a=K(i,o.type);0!==a.length?(r=C(i,o.type),t=I(r,o.name),R(t,E(e))):t=ie.serializeObject(i,e,o.name,o)}R(u,t)})}v=v.filter(function(e){return e!==o.name})}});var d;y(F(i,c),function(e){r(e.name)?d=e:r(a[e.name])&&v.indexOf(e.name)===-1||t(a[e.name])||(ie.isBuiltInType(e.type)?m(u,e.name,B(i,e.type,a[e.name])):m(u,e.name,a[e.name]),v=v.filter(function(t){return t!==e.name}))});var h=Y(i,c);return ie.isBuiltInType(h)&&(R(u,E(B(i,h,a.value))),v.splice(v.indexOf("value"),1)),r(f)||(y(v,function(t){var n=e(a[t])?a[t]:[a[t]];y(n,function(e){R(u,ie.serializeObject(i,e,t))})}),v=[]),r(d)||(y(v,function(e){m(u,e,B(i,L(i,a[e].constructor),a[e]))}),v=[]),u},serializeRequest:function(e){return se.serializeToString(e).replace('<Envelope xmlns="'+Z+'">','<Envelope xmlns="'+Z+'" xmlns:xs="'+ne+'" xmlns:xsi="'+re+'">')},validateObject:function(i,a,o,s){var u=L(i,a.constructor);if(r(u))throw Error("Unknown type");if(!r(s)){var c=s.type;if(A(u)!==A(c)||z(u)!==z(c)){var p=U(i)[C(i,c)];if(!r(p)&&!("anyType"===X(i,c)||a instanceof q(i,c)))throw Error("Unexpected object type")}}var f,m=l(a),v=V(i,u);y($(i,u),function(o){if(r(o.name))f=o;else{var s=a[o.name];if(r(s)&&m.indexOf(o.name)===-1||t(s)){var u=o.minOccurs||v.minOccurs;if("0"!==u)throw Error("Required property not defined")}else{var c=e(s)?s:[s];y(c,function(e){if(n(e)||!ie.isBuiltInType(o.type)){var t=K(i,o.type);if(0!==t.length){if(t.indexOf(e)===-1)throw Error("Invalid enum value")}else ie.validateObject(i,e,o.name,o)}})}m=m.filter(function(e){return e!==o.name})}});var d;y(F(i,u),function(e){if(r(e.name))d=e;else if(r(a[e.name])&&m.indexOf(e.name)===-1||t(a[e.name])){if("required"===e.use)throw Error("Required attribute not defined")}else{if(!ie.isBuiltInType(e.type)){var n=K(i,e.type);if(n.indexOf(a[e.name])===-1)throw Error("Invalid enum value")}m=m.filter(function(t){return t!==e.name})}});var h=Y(i,u);if(ie.isBuiltInType(h)&&m.splice(m.indexOf("value"),1),!r(f)){var g=f.maxOccurs||v.maxOccurs;if("unbounded"!==g&&m.length>parseInt(g))throw Error("Unnecessary property specified");y(m,function(t){var n=e(a[t])?a[t]:[a[t]];y(n,function(e){ie.validateObject(i,e,t)})}),m=[]}if(r(d)||(m=[]),m.length>0)throw Error("Unnecessary property specified")}},oe=new(i(typeof DOMParser)?require("xmldom").DOMParser:DOMParser),se=new(i(typeof XMLSerializer)?require("xmldom").XMLSerializer:XMLSerializer),ue=i(typeof document)?oe.parseFromString("<xml/>"):document;return ie}var ye=0,de=1,he=0,ge=1,be={debug:!1,proxy:!1,proxyHeader:"vSphere-Target"},xe={},we=le(),Oe=ve(),Te=i(typeof localStorage)?new(require("node-localstorage").LocalStorage)(require("path").join(".localStorage")):localStorage;me({cisService:function(e,t){return fe(e,we.createOptions({definitions:["applmgmt","com.vmware.cis","com.vmware.cis.tagging","com.vmware.content","com.vmware.vcenter","com.vmware.vcenter.ovf"],endpoint:"/api",key:"cisService",prefixes:{applmgmt:"com.vmware.appliance",cis:"com.vmware.cis",content:"com.vmware.content",ovf:"com.vmware.vcenter.ovf",tagging:"com.vmware.cis.tagging",vcenter:"com.vmware.vcenter"}},t))},integrityService:function(e,t){return fe(e,Oe.createOptions({init:function(e,t,n,r){var i=r["urn:vim25"],a=n["urn:integrityService"],o=i.ManagedObjectReference({type:"ServiceInstance",value:"Integrity.VcIntegrity"});return a.retrieveVcIntegrityContent(o).then(function(e){return{props:{serviceContent:e,serviceInstance:o},key:[t.key,e.about.apiVersion].join("/")}})},endpoint:"/vci/sdk",key:"integrityService",port:8084,prefixes:{integrity:"urn:integrity",integrityPort:"urn:integrityService",vim:"urn:vim25"}},t))},srmService:function(e,t){return fe(e,Oe.createOptions({init:function(e,t,n,r){var i=r["urn:vim25"],a=n["urn:srm0Service"],o=i.ManagedObjectReference({type:"SrmServiceInstance",value:"SrmServiceInstance"});return a.retrieveContent(o).then(function(e){return{props:{serviceContent:e,serviceInstance:o},key:[t.key,e.about.version].join("/")}})},definitions:["/srm-Service.wsdl"],endpoint:"/vcdr/extapi/sdk",key:"srmService",port:9086,prefixes:{srm:"urn:srm0",srmPort:"urn:srm0Service",vim:"urn:vim25"}},t))},stsService:function(e,t){return fe(e,Oe.createOptions({definitions:["/sts/STSService?wsdl"],endpoint:"/sts/STSService",key:"stsService",prefixes:{del:"urn:oasis:names:tc:SAML:2.0:conditions:delegation",dsig:"http://www.w3.org/2000/09/xmldsig#",saml:"urn:oasis:names:tc:SAML:2.0:assertion",smle:"http://www.rsa.com/names/2009/12/std-ext/SAML2.0",smlp:"http://www.rsa.com/names/2010/04/std-prof/SAML2.0",stsPort:"http://docs.oasis-open.org/ws-sx/ws-trust/200512/wsdl",wsa:"http://www.w3.org/2005/08/addressing",wsse:"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd",wst13:"http://docs.oasis-open.org/ws-sx/ws-trust/200512",wst14:"http://docs.oasis-open.org/ws-sx/ws-trust/200802",wsta:"http://www.rsa.com/names/2009/12/std-ext/WS-Trust1.4/advice",wsu:"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"}},t))},vimService:function(e,t){return fe(e,Oe.createOptions({init:function(e,t,n,r){var i=r["urn:vim25"],a=n["urn:vim25Service"],o=i.ManagedObjectReference({type:"ServiceInstance",value:"ServiceInstance"});return a.retrieveServiceContent(o).then(function(e){return{props:{serviceContent:e,serviceInstance:o},key:[t.key+":"+e.about.apiType,e.about.version].join("/")}})},definitions:["/sdk/vimService.wsdl"],endpoint:"/sdk",key:"vimService",prefixes:{vim:"urn:vim25",vimPort:"urn:vim25Service"}},t))},vsanhealthService:function(e,t){return fe(e,Oe.createOptions({endpoint:"/vsanHealth",key:"vsanhealthService",prefixes:{vim:"urn:vim25",vsanhealthPort:"urn:vim25Service"}},t))}})}();