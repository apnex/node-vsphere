// ----------queryConfigOptionEx----------
var spec = new VcEnvironmentBrowserConfigOptionQuerySpec();
var guestId = new Array();
guestId[0] = 'centos7_64Guest';
spec.guestId = guestId;
spec.key = 'vmx-17';
managedObject.queryConfigOptionEx(spec);   // EnvironmentBrowser-envbrowser-13


// ----------createChildVM_Task----------
var config = new VcVirtualMachineConfigSpec();
config.numCPUs = 1;
config.flags = new VcVirtualMachineFlagInfo();
config.flags.virtualMmuUsage = 'automatic';
config.flags.monitorType = 'release';
config.flags.enableLogging = true;
config.virtualSMCPresent = false;
config.maxMksConnections = 40;
var cpuFeatureMask = new Array();
config.cpuFeatureMask = cpuFeatureMask;
config.tools = new VcToolsConfigInfo();
config.tools.beforeGuestShutdown = true;
config.tools.toolsUpgradePolicy = 'manual';
config.tools.beforeGuestStandby = true;
config.tools.afterResume = true;
config.tools.afterPowerOn = true;
config.version = 'vmx-17';
config.latencySensitivity = new VcLatencySensitivity();
config.latencySensitivity.level = VcLatencySensitivitySensitivityLevel.normal;
config.virtualICH7MPresent = false;
config.memoryMB = 2048;
config.memoryAllocation = new VcResourceAllocationInfo();
config.memoryAllocation.shares = new VcSharesInfo();
config.memoryAllocation.shares.shares = 20480;
config.memoryAllocation.shares.level = VcSharesLevel.normal;
config.memoryAllocation.limit = -1;
config.memoryAllocation.reservation = 0;
config.numCoresPerSocket = 1;
config.bootOptions = new VcVirtualMachineBootOptions();
config.migrateEncryption = 'opportunistic';
config.cpuAllocation = new VcResourceAllocationInfo();
config.cpuAllocation.shares = new VcSharesInfo();
config.cpuAllocation.shares.shares = 1000;
config.cpuAllocation.shares.level = VcSharesLevel.normal;
config.cpuAllocation.limit = -1;
config.cpuAllocation.reservation = 0;
var deviceChange = new Array();
deviceChange[0] = new VcVirtualDeviceConfigSpec();
deviceChange[0].device = new VcVirtualMachineVideoCard();
deviceChange[0].device.numDisplays = 1;
deviceChange[0].device.useAutoDetect = false;
deviceChange[0].device.controllerKey = 100;
deviceChange[0].device.unitNumber = 0;
deviceChange[0].device.use3dRenderer = 'automatic';
deviceChange[0].device.enable3DSupport = false;
deviceChange[0].device.deviceInfo = new VcDescription();
deviceChange[0].device.deviceInfo.summary = 'Video card';
deviceChange[0].device.deviceInfo.label = 'Video card ';
deviceChange[0].device.key = 500;
deviceChange[0].device.videoRamSizeInKB = 8192;
deviceChange[0].operation = VcVirtualDeviceConfigSpecOperation.add;
deviceChange[1] = new VcVirtualDeviceConfigSpec();
deviceChange[1].device = new VcParaVirtualSCSIController();
deviceChange[1].device.sharedBus = VcVirtualSCSISharing.noSharing;
deviceChange[1].device.scsiCtlrUnitNumber = 7;
deviceChange[1].device.deviceInfo = new VcDescription();
deviceChange[1].device.deviceInfo.summary = 'New SCSI controller';
deviceChange[1].device.deviceInfo.label = 'New SCSI controller';
deviceChange[1].device.key = -101;
deviceChange[1].device.busNumber = 0;
deviceChange[1].operation = VcVirtualDeviceConfigSpecOperation.add;
deviceChange[2] = new VcVirtualDeviceConfigSpec();
deviceChange[2].fileOperation = VcVirtualDeviceConfigSpecFileOperation.create;
deviceChange[2].device = new VcVirtualDisk();
deviceChange[2].device.capacityInBytes = 17179869184;
deviceChange[2].device.storageIOAllocation = new VcStorageIOAllocationInfo();
deviceChange[2].device.storageIOAllocation.shares = new VcSharesInfo();
deviceChange[2].device.storageIOAllocation.shares.shares = 1000;
deviceChange[2].device.storageIOAllocation.shares.level = VcSharesLevel.normal;
deviceChange[2].device.storageIOAllocation.limit = -1;
deviceChange[2].device.backing = new VcVirtualDiskFlatVer2BackingInfo();
deviceChange[2].device.backing.fileName = '[ds-esx03]';
deviceChange[2].device.backing.eagerlyScrub = false;
deviceChange[2].device.backing.thinProvisioned = false;
deviceChange[2].device.backing.diskMode = 'persistent';
deviceChange[2].device.controllerKey = -101;
deviceChange[2].device.unitNumber = 0;
deviceChange[2].device.capacityInKB = 16777216;
deviceChange[2].device.deviceInfo = new VcDescription();
deviceChange[2].device.deviceInfo.summary = 'New Hard disk';
deviceChange[2].device.deviceInfo.label = 'New Hard disk';
deviceChange[2].device.key = -102;
deviceChange[2].operation = VcVirtualDeviceConfigSpecOperation.add;
deviceChange[3] = new VcVirtualDeviceConfigSpec();
deviceChange[3].device = new VcVirtualVmxnet3();
deviceChange[3].device.macAddress = '';
deviceChange[3].device.connectable = new VcVirtualDeviceConnectInfo();
deviceChange[3].device.connectable.connected = true;
deviceChange[3].device.connectable.allowGuestControl = true;
deviceChange[3].device.connectable.startConnected = true;
deviceChange[3].device.backing = new VcVirtualEthernetCardNetworkBackingInfo();
deviceChange[3].device.backing.deviceName = 'vss-vmnet';
deviceChange[3].device.backing.network = Server.findForType("VC:Network", managedObject.vimHost.id + "/network-28");
deviceChange[3].device.addressType = 'generated';
deviceChange[3].device.deviceInfo = new VcDescription();
deviceChange[3].device.deviceInfo.summary = 'New Network';
deviceChange[3].device.deviceInfo.label = 'New Network';
deviceChange[3].device.key = -103;
deviceChange[3].operation = VcVirtualDeviceConfigSpecOperation.add;
deviceChange[4] = new VcVirtualDeviceConfigSpec();
deviceChange[4].device = new VcVirtualAHCIController();
deviceChange[4].device.deviceInfo = new VcDescription();
deviceChange[4].device.deviceInfo.summary = 'New SATA Controller';
deviceChange[4].device.deviceInfo.label = 'New SATA Controller';
deviceChange[4].device.key = -104;
deviceChange[4].device.busNumber = 0;
deviceChange[4].operation = VcVirtualDeviceConfigSpecOperation.add;
deviceChange[5] = new VcVirtualDeviceConfigSpec();
deviceChange[5].device = new VcVirtualCdrom();
deviceChange[5].device.connectable = new VcVirtualDeviceConnectInfo();
deviceChange[5].device.connectable.connected = false;
deviceChange[5].device.connectable.allowGuestControl = true;
deviceChange[5].device.connectable.startConnected = false;
deviceChange[5].device.backing = new VcVirtualCdromRemotePassthroughBackingInfo();
deviceChange[5].device.backing.exclusive = false;
deviceChange[5].device.backing.deviceName = '';
deviceChange[5].device.controllerKey = -104;
deviceChange[5].device.unitNumber = 0;
deviceChange[5].device.deviceInfo = new VcDescription();
deviceChange[5].device.deviceInfo.summary = 'New CD/DVD Drive';
deviceChange[5].device.deviceInfo.label = 'New CD/DVD Drive';
deviceChange[5].device.key = -105;
deviceChange[5].operation = VcVirtualDeviceConfigSpecOperation.add;
config.deviceChange = deviceChange;
config.memoryReservationLockedToMax = false;
config.name = 'New Virtual Machine';
config.files = new VcVirtualMachineFileInfo();
config.files.vmPathName = '[ds-esx03]';
config.cpuAffinity = new VcVirtualMachineAffinityInfo();
var affinitySet = new Array();
config.cpuAffinity.affinitySet = affinitySet;
config.powerOpInfo = new VcVirtualMachineDefaultPowerOpInfo();
config.powerOpInfo.suspendType = 'preset';
config.powerOpInfo.standbyAction = 'checkpoint';
config.powerOpInfo.resetType = 'preset';
config.powerOpInfo.powerOffType = 'preset';
config.swapPlacement = 'inherit';
config.firmware = 'bios';
config.guestId = 'centos7_64Guest';
managedObject.createChildVM_Task(config, null);   // VirtualApp-resgroup-v2023

#----------------- End of code capture -----------------
